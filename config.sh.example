#!/usr/bin/env bash

export PROJECT_DIR
PROJECT_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
export INSTALL_DIR=${PROJECT_DIR}/android_lib
export TOOLCHAIN_DIR=${PROJECT_DIR}/toolchains
export ANDROID_ABI=${ANDROID_ABI:-"arm64-v8a"}
export N_JOBS=${N_JOBS:-4}
export NDK_ROOT=${NDK_ROOT:-"/opt/android-ndk-r11c"}

case "$(uname -s)" in
    Darwin)
        OS=darwin
    ;;
    Linux)
        OS=linux
    ;;
    CYGWIN*|MINGW*|MSYS*)
        OS=windows
    ;;
    *)
        echo "Unknown OS"
        exit 1
    ;;
esac
export OS

if [ "$(uname -m)" = "x86_64" ]; then
    ARCH=x86_64
else
    ARCH=x86
fi
export ARCH

case "$ANDROID_ABI" in
    "armeabi-v7a-hard-softfp with NEON")
        TOOLCHAIN=arm-linux-androideabi-4.9
        ABI=armeabi-v7a
        ;;
    "arm64-v8a")
        TOOLCHAIN=aarch64-linux-android-4.9
        ABI=arm64-v8a
        ;;
    "armeabi")
        TOOLCHAIN=arm-linux-androideabi-4.9
        ABI=armeabi
        ;;
    "x86")
        TOOLCHAIN=x86-4.9
        ABI=x86
        ;;
    "x86_64")
        TOOLCHAIN=x86_64-4.9
        ABI=x86_64
        ;;
    *)
        echo "Error: ${ANDROID_ABI} is not supported"
        exit 1
        ;;
esac
export TOOLCHAIN
export TOOLCHAIN_DIR=${PROJECT_DIR}/toolchains/$ABI
